# Стратегия торговли BTC на Gate.io

## Что у нас уже есть (из проекта):

### ✅ Готовые компоненты:
1. **Парсер Gate.io** - `src/exchanges/gate/parser.rs` - парсит WebSocket сообщения
2. **API Gate.io** - `src/execution/gate_client.rs` + `gate_ws.rs` - полная поддержка исполнения
3. **OrderManager** - `src/execution/order_manager.rs` - управление ордерами
4. **InventoryTracker** - `src/execution/inventory.rs` - отслеживание позиций
5. **Базовая стратегия** - `src/strategy/simple_quote.rs` - маркет-мейкинг
6. **Стоп-лосс** - `src/strategy/stop_loss.rs` - базовая логика
7. **Модели** - `src/models/` - Position, MarketData и т.д.

### ⚠️ Что нужно доработать:
1. **Индикаторы** - есть структура, но не все реализованы (RSI, MACD - TODO)
2. **Скринер** - есть базовая структура, нужно наполнить логикой
3. **Интеграция стоп-лосса** - есть функция, но не интегрирована в стратегию

## Архитектура стратегии для BTC

```
┌─────────────────────────────────────────────────────────────┐
│  Gate.io WebSocket Feed                                     │
│  (уже есть: src/exchanges/gate/)                            │
└──────────────────┬──────────────────────────────────────────┘
                   │
                   ▼
┌─────────────────────────────────────────────────────────────┐
│  Парсер рыночных данных                                      │
│  (уже есть: src/exchanges/gate/parser.rs)                  │
│  - Цены BTC_USDT                                            │
│  - Orderbook updates                                        │
│  - Trade data                                               │
└──────────────────┬──────────────────────────────────────────┘
                   │
                   ▼
┌─────────────────────────────────────────────────────────────┐
│  Скринер сигналов                                            │
│  (расширить: src/screener/)                                 │
│  - Фильтрация по условиям                                   │
│  - Определение точек входа/выхода                           │
└──────────────────┬──────────────────────────────────────────┘
                   │
                   ▼
┌─────────────────────────────────────────────────────────────┐
│  Индикаторы                                                  │
│  (доработать: src/indicators/)                              │
│  - RSI, MACD, SMA, Bollinger Bands                          │
│  - Генерация торговых сигналов                               │
└──────────────────┬──────────────────────────────────────────┘
                   │
                   ▼
┌─────────────────────────────────────────────────────────────┐
│  Торговая стратегия BTC                                      │
│  (создать: src/strategy/btc_strategy.rs)                    │
│  - Анализ сигналов                                           │
│  - Расчет точек входа                                        │
│  - Управление позицией                                       │
│  - Стоп-лосс / Тейк-профит                                   │
└──────────────────┬──────────────────────────────────────────┘
                   │
                   ▼
┌─────────────────────────────────────────────────────────────┐
│  OrderManager + Execution                                    │
│  (уже есть: src/execution/)                                │
│  - Отправка ордеров на Gate.io                              │
│  - Отслеживание исполнения                                  │
│  - Управление позициями                                      │
└──────────────────┬──────────────────────────────────────────┘
                   │
                   ▼
┌─────────────────────────────────────────────────────────────┐
│  Стоп-лосс мониторинг                                       │
│  (интегрировать: src/strategy/stop_loss.rs)                 │
│  - Постоянная проверка позиций                              │
│  - Автоматическое закрытие при достижении уровня            │
└─────────────────────────────────────────────────────────────┘
```

## Использование существующих компонентов

### 1. Парсер (уже есть) ✅
```rust
// Используем существующий парсер Gate.io
use crate::exchanges::gate::parser::*;
use crate::base_classes::feed_gate::*;

// Данные уже парсятся в gate_runner.rs через spawn_state_engine
```

### 2. API Gate.io (уже есть) ✅
```rust
// Используем готовый GateClient и GateWsGateway
use crate::execution::{GateClient, GateWsGateway, GateCredentials};
use crate::execution::order_manager::OrderManager;
```

### 3. InventoryTracker (уже есть) ✅
```rust
// Отслеживание позиций уже реализовано
use crate::execution::inventory::{InventoryTracker, InventoryReportOutcome};
```

### 4. Стоп-лосс (есть базовая логика, нужно интегрировать)
```rust
// Функции есть в src/strategy/stop_loss.rs
use crate::strategy::stop_loss::{check_stop_loss, check_take_profit};
use crate::models::Position;
```

## План реализации

### Шаг 1: Создать стратегию BTC
Файл: `src/strategy/btc_strategy.rs`

### Шаг 2: Интегрировать скринер
Расширить `src/screener/` для фильтрации сигналов BTC

### Шаг 3: Доработать индикаторы
Реализовать RSI, MACD в `src/indicators/`

### Шаг 4: Создать runner для BTC
Новый `src/bin/btc_runner.rs` на основе `gate_runner.rs`

### Шаг 5: Интегрировать стоп-лосс
Добавить мониторинг в стратегию

