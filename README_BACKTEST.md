# üöÄ HFT Backtest Engine - –ü–æ–ª–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### Core Engine
- ‚úÖ **Tick-by-tick —Å–∏–º—É–ª—è—Ü–∏—è** - –∫–∞–∂–¥—ã–π —Ç–∏–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ
- ‚úÖ **Full Order Book (L2/L3)** - –ø–æ–ª–Ω–∞—è —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å—Ç–∞–∫–∞–Ω–∞ —Å –æ—á–µ—Ä–µ–¥—è–º–∏
- ‚úÖ **Latency Modeling** - —Å–ª—É—á–∞–π–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ 10-20 –º—Å
- ‚úÖ **Order Fill Simulation** - FIFO/ProRata/TimePriority –º–æ–¥–µ–ª–∏
- ‚úÖ **Monte Carlo** - –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω—ã–µ –ø—Ä–æ–≥–æ–Ω—ã –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- ‚úÖ **–§–æ—Ä–º–∞—Ç .bin** - —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å MoonBot

### –§–∏–ª—å—Ç—Ä—ã –∏ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã
- ‚úÖ –î–µ–ª—å—Ç–∞ —Ñ–∏–ª—å—Ç—Ä—ã (1–º-24—á)
- ‚úÖ –û–±—ä–µ–º–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã
- ‚úÖ –§–∏–ª—å—Ç—Ä —Å—Ç–∞–≤–∫–∏ —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –§–∏–ª—å—Ç—Ä—ã —à–∞–≥–∞ —Ü–µ–Ω—ã –∏ –º–∞—Ä–∫ –ø—Ä–∞–π—Å–∞
- ‚úÖ –¢–æ–ø-N —Ä—ã–Ω–∫–æ–≤ –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—é

### –ú–µ—Ç—Ä–∏–∫–∏ –∏ —Ä–µ–π—Ç–∏–Ω–≥
- ‚úÖ –ü–æ–ª–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ P&L
- ‚úÖ –†–µ–π—Ç–∏–Ω–≥ 0-10 –ø–æ 4 –∫—Ä–∏—Ç–µ—Ä–∏—è–º
- ‚úÖ –ó–≤–µ–∑–¥—ã 0-5
- ‚úÖ Fill rate –∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–¥–µ–ª–æ–∫

### MoonBot –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
- ‚úÖ MShot (–±–∞–∑–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
- ‚úÖ MStrike, Hook, Spread (–∑–∞–≥–ª—É—à–∫–∏ –≥–æ—Ç–æ–≤—ã –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–¥–µ–ª–∞—Ç—å

1. **–ó–∞–≤–µ—Ä—à–∏—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏** - –ø–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è MStrike/Hook/Spread
2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - –ø–æ–¥–∫–ª—é—á–∏—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∫ –±—ç–∫—Ç–µ—Å—Ç–µ—Ä—É
3. **API endpoints** - —Ä–∞—Å—à–∏—Ä–∏—Ç—å investor_portal.rs
4. **–ò–ò –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** - Optuna/Nevergrad –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```rust
use rust_test::backtest::*;

let settings = BacktestSettings::default();
let mut engine = BacktestEngine::new(settings);

let mut replay = ReplayEngine::new(Default::default());
replay.load_bin_file("data/BTC.bin")?;

for stream in replay.take_streams() {
    engine.add_stream(stream);
}

let result = engine.run()?;
println!("‚≠ê Rating: {:.2}/10, Stars: {}", 
    result.rating.overall_rating, result.rating.stars);
```

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–í—Å–µ –º–æ–¥—É–ª–∏ —Å–æ–∑–¥–∞–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:
- `backtest/engine.rs` - –æ—Å–Ω–æ–≤–Ω–æ–π –¥–≤–∏–∂–æ–∫
- `backtest/orderbook.rs` - L2/L3 —Å—Ç–∞–∫–∞–Ω
- `backtest/filters.rs` - —Ñ–∏–ª—å—Ç—Ä—ã —Ä—ã–Ω–∫–æ–≤
- `backtest/metrics.rs` - –º–µ—Ç—Ä–∏–∫–∏ –∏ —Ä–µ–π—Ç–∏–Ω–≥
- `strategy/moon_strategies/` - MoonBot —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

–ì–æ—Ç–æ–≤–æ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è!

